<p-toast></p-toast>

<h1 class="text-center mb-4">Panier</h1>

@if (cartItems().length === 0) {
    <div class="text-center p-4">
        <p class="text-secondary text-xl">Votre panier est vide</p>
    </div>
} @else {
    <div class="cart-list">
        @for (item of cartItems(); track item.id) {
            <div class="cart-item p-3 mb-3 surface-card border-round flex align-items-center gap-3">
                <div class="flex-1">
                    <div class="text-lg font-bold mb-1">{{ item.product.name }}</div>
                    <div class="text-sm text-secondary mb-2">{{ item.product.category }}</div>
                    <div class="flex align-items-center gap-3">
                        <span class="text-xl font-bold text-primary">{{ item.product.price }} €</span>
                        <span class="text-sm text-secondary">x</span>
                        <div class="flex align-items-center gap-2">
                            <p-inputNumber 
                                [ngModel]="item.quantity" 
                                [min]="1" 
                                [max]="item.product.quantity"
                                [showButtons]="true"
                                (onInput)="onQuantityChange(item, $event.value)"
                                styleClass="cart-quantity-input" />
                            <p-button 
                                icon="pi pi-trash" 
                                severity="danger" 
                                [styleClass]="'p-button-rounded p-button-text p-button-sm'"
                                (onClick)="onRemoveFromCart(item)"
                                [pTooltip]="'Supprimer du panier'" />
                        </div>
                        <span class="text-lg font-bold ml-auto">
                            = {{ (item.product.price * item.quantity) | number:'1.2-2' }} €
                        </span>
                    </div>
                </div>
            </div>
        }
    </div>
    
    <div class="mt-4 p-4 surface-card border-round">
        <div class="flex justify-content-between align-items-center mb-3">
            <span class="text-xl font-bold">Total:</span>
            <span class="text-2xl font-bold text-primary">{{ total() | number:'1.2-2' }} €</span>
        </div>
        <div class="flex gap-2">
            <p-button 
                label="Vider le panier" 
                icon="pi pi-trash" 
                severity="danger" 
                (onClick)="onClearCart()"
                [style]="{ flex: 1 }" />
            <p-button 
                label="Commander" 
                icon="pi pi-check" 
                severity="success" 
                [style]="{ flex: 1 }" />
        </div>
    </div>
}
